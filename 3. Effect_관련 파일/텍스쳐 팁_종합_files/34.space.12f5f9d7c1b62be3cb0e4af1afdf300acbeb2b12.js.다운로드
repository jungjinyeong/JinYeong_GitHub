(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{768:function(e,i){e.exports=function(e){var i={},a=null,n={delay:1,rows:2,duration:5,ready:function(){},detach:function(){}};function o(){var e;if(!i._isLoaded){var a="";i.data.forEach((function(e,i){a+='<div class="fake-danmu-item">'+e+"</div>"})),e='<div class="fake-danmu">'+a+"</div>",i.cover.append(e)}if(i._isTouching){var n=i.cover;i.fakeDanmu=n.find(".fake-danmu"),i.danmuItem=n.find(".fake-danmu-item"),i.coverWidth=n.width(),i.length=i.danmuItem.length,i._isReady=!0,i.config.ready(i.aid),setTimeout(d,1e3)}}function d(){i._isReady&&i._isTouching&&(i.fakeDanmu.fadeIn(200),i.danmuItem.each(s))}function s(n,o){var d={},s=e(o),t=s.width(),c=i.config,f=c.duration,u=c.rows,v=i.coverWidth,p=n*f/u/u;d.top=n%2==0?8:"25px",d.left=v+"px",d.transform="translate3d(-"+(v+t)+"px, 0, 0)",d.transition="transform "+f+"s linear "+p+"s",s.css(d),n===i.length-1&&(a=setTimeout(r,1e3*(p+f)))}function r(){i._isReady&&i._isTouching&&i.danmuItem.each((function(i,n){e(n).css({transform:"",transition:""}),function(e,i){a=setTimeout((function(){s(e,i)}),1e3)}(i,n)}))}return function(d){var s;d&&d.video&&d.cover&&(this.config=e.extend({},n,d),s=(i=this).config.cover,e("body").on("mouseenter.preview",s,(function(){var n=e(this),d=n.closest(i.config.video).data("aid");i.aid=d,i._isReady=!1,i._isLoaded=!1,clearTimeout(a),a=setTimeout((function(){i.cover=n;var a=i._isLoaded=!!n.find(".fake-danmu").length;i._isTouching=!0,n.find(".fake-danmu-mask").length||n.append('<div class="fake-danmu-mask"></div>'),i.video=n.closest(".fakeDanmu-item").addClass("preview-danmu"),i.danmuMask=n.find(".fake-danmu-mask").fadeIn(200),a?o():e.ajax({url:"//api.bilibili.com/x/v2/dm/ajax",data:{aid:i.aid,jsonp:"jsonp"},dataType:"jsonp"}).done((function(e){0===e.code&&(null===e.data?i.data=[]:i.data=e.data),o()}))}),100)})).on("mouseleave.preview",s,(function(){var e=i.aid;clearTimeout(a),i.config.detach(e),i._isReady&&(i.fakeDanmu.stop().hide(),i.danmuItem.removeAttr("style")),i._isTouching&&(i.danmuMask.stop().fadeOut(200),i.video.removeClass("preview-danmu")),i.danmuItem=i.fakeDanmu=i.video=i.danmuMask=i.data=null,i._isReady=i._isLoaded=i._isTouching=!1,i.data=i.aid=void 0})))}}($)},769:function(e,i){e.exports=function(e){var i={},a={},n=null,o={frames:10,ready:function(){},detach:function(){}};function d(e){var i=a.cover;if(a.data=e,a._isReady=!0,a._isLoaded||i.append('<div class="preview-bg"></div><div class="preview-wrapper"><div class="preview-loading"></div><div class="preview-progress"><div class="preview-progress-bar"></div></div></div>'),a._isTouching){if(a.config.ready(a.aid),a.previewBg=i.find(".preview-bg"),a.progressWrapper=i.find(".preview-wrapper"),a.progressBar=i.find(".preview-progress-bar"),!e.image[0])return;!function(){var e=a.config.frames,i=new Image,n=a.data,o=(t=n.image[0],t?t.replace(/https?:/,""):""),d=n.index.length;var t;i.onload=function(){a._isReady&&a._isTouching&&(a.previewBg.css({backgroundImage:"url("+o+")"}).stop().fadeIn(),a.progressWrapper.stop().fadeIn())},i.src=o,d<=e&&(a.frames=d);a._isReady&&a._isTouching&&(s(),r())}()}}function s(){a.progressBar.width(100*a.offset.toFixed(2)+"%")}function r(){var e=a.data,i=a.previewBg,n=a.coverWidth,o=e.img_y_size/e.img_x_size*n,d=Math.floor(a.offset*a.frames),s=-d%e.img_x_len*n,r=-Math.floor(d/e.img_x_len)*o;i.css({backgroundPosition:s+"px "+r+"px",backgroundSize:e.img_x_len*n})}return function(t){var c;t&&t.video&&t.cover&&(this.config=e.extend({},o,t),c=(a=this).config.cover,e("body").on("mouseenter.preview",c,(function(o){var s=e(this),r=s.closest(a.config.video).data("aid");a.aid=r,a._isReady=!1,a._isLoaded=!1,clearTimeout(n),n=setTimeout((function(){a.cover=s,a.coverWidth=s.width(),a.offset=o.offsetX/a.coverWidth,a.frames=a.config.frames,a._isTouching=!0,a._isLoaded=s.find(".preview-bg").length;var n=i[r];n?d(n):e.ajax({url:"//api.bilibili.com/x/player/videoshot",data:{bvid:a.aid,index:1}}).done((function(e){if(e&&0===e.code){var a=e.data;i[r]=a,d(a)}}))}),100)})).on("mouseleave.preview",c,(function(){clearTimeout(n),a.config.detach(a.aid),a.progressWrapper&&(a.progressWrapper.stop().fadeOut(),a.previewBg.stop().fadeOut()),a.progressBar=a.progressWrapper=a.previewBg=a.data=null,a._isReady=a._isLoaded=a._isTouching=!1,a.aid=void 0})).on("mousemove.preview",c,(function(i){if(a.progressBar){var n=i.pageX-e(this).offset().left;a.offset=n/a.coverWidth,s(),r()}})))}}($)}}]);
//# sourceMappingURL=34.space.12f5f9d7c1b62be3cb0e4af1afdf300acbeb2b12.js.map